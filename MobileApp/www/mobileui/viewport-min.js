var ViewPort=function(g,a){var f=this;this.viewPortId=g;this.viewPortSelector="#"+g;var b=$(this.viewPortSelector);var e=null;var d=null;var c=null;this.slideDuration=250;this.fadeDuration=250;this.pages=new Array();this.currentPageId=a;this.isiScroll=false;this.getId=function(){return $this.id};this.addPage=function(h){};this.createPage=function(h,i){};this.showPage=function(j,o,n,i,k,p,q){if(j!=this.currentPageId){var m=this.currentPageId;if(typeof f.onPreShowPage=="function"){if(!f.onPreShowPage(m,j,o,n)){return}}var l=$("#"+j);var h=$("#"+this.currentPageId);if(l.height()!=b.height()){l.height(b.height())}switch(o){case"NONE":h.css("display","none");l.css({top:"0px",left:"0px",display:"block"});if(typeof i=="function"){i(m,j,o,n,q)}if(typeof f.onShowPage=="function"){f.onShowPage(m,j,o,n,q)}break;case"FADE":l.css({top:"0px",left:"0px",display:"none"});h.fadeOut(this.fadeDuration);l.fadeIn(this.fadeDuration,function(){if(typeof i=="function"){i(m,j,o,n,q)}if(typeof f.onShowPage=="function"){f.onShowPage(m,j,o,n,q)}});break;case"SLIDE_RIGHT":l.css({top:"0px",left:"-"+b.width()+"px",display:"block"});h.animate({left:b.width()+"px"},this.slideDuration,function(){h.hide()});l.animate({left:"0px"},this.slideDuration,function(){if(typeof i=="function"){i(m,j,o,n,q)}if(typeof f.onShowPage=="function"){f.onShowPage(m,j,o,n,q)}});break;case"SLIDE_LEFT":l.css({top:"0px",left:b.width()+"px",display:"block"});h.animate({left:"-"+b.width()+"px"},this.slideDuration,function(){h.hide()});l.animate({left:"0px"},this.slideDuration,function(){if(typeof i=="function"){i(m,j,o,n,q)}if(typeof f.onShowPage=="function"){f.onShowPage(m,j,o,n,q)}});break;case"SLIDE_UP":l.css({top:b.height()+"px",left:"0px",display:"block"});h.animate({top:"-"+b.height()+"px"},this.slideDuration,function(){});l.animate({top:"0px"},this.slideDuration,function(){if(typeof i=="function"){i(m,j,o,n,q)}if(typeof f.onShowPage=="function"){f.onShowPage(m,j,o,n,q)}});break;case"SLIDE_DOWN":l.css({top:"-"+b.height()+"px",left:"0px",display:"block"});h.animate({top:b.height()+"px"},this.slideDuration,function(){h.hide()});l.animate({top:"0px"},this.slideDuration,function(){if(typeof i=="function"){i(m,j,o,n,q)}if(typeof f.onShowPage=="function"){f.onShowPage(m,j,o,n,q)}});break}if(p==undefined||p==true){mui.history.push(m,o,this,1,k)}this.currentPageId=j;this.iScrollRefresh()}};this.showPanel=function(k,m,n,h,i){if(d==null){this.putCoverShild(null,function(){f.closePanel()});var l="#"+k;d=$(l);var j=$("#"+this.currentPageId);switch(m){case"NONE":d.css({top:"0px",left:"0px",display:"block"});if(typeof n=="function"){n(this.currentPage,k,m)}break;case"FADE":d.css({top:"0px",left:"0px",display:"none"});d.fadeIn(this.fadeDuration,function(){if(typeof n=="function"){n(this.currentPage,k,m)}});break;case"SLIDE_RIGHT":d.css({top:"0px",left:(-1*d.width())+"px",display:"block"}).animate({left:"0px"},this.slideDuration);j.animate({left:d.width()+"px"},this.slideDuration,function(){if(typeof n=="function"){n(this.currentPage,k,m)}});break;case"SLIDE_LEFT":d.css({top:"0px",left:b.width()+"px",display:"block"});d.animate({left:(b.width()-d.width())+"px"},this.slideDuration);j.animate({left:(-1*d.width())+"px"},this.slideDuration,function(){if(typeof n=="function"){n(this.currentPage,k,m)}});break;case"FLOAT_RIGHT":d.css({top:"0px",left:(-1*d.width())+"px",display:"block"}).animate({left:"0px"},this.slideDuration,function(){if(typeof n=="function"){n(this.currentPage,k,m)}});break;case"FLOAT_LEFT":d.css({top:"0px",left:b.width()+"px",display:"block"}).animate({left:(b.width()-d.width())+"px"},this.slideDuration,function(){if(typeof n=="function"){n(this.currentPage,k,m)}});break;case"SLIDE_UP":d.css({top:b.height()+"px",left:"0px",display:"block"}).animate({top:(f.height-d.height())+"px"},this.slideDuration);j.animate({top:(-1*d.height())+"px"},this.slideDuration,function(){if(typeof n=="function"){n(this.currentPage,k,m)}});break;case"SLIDE_DOWN":d.css({top:(-1*d.height())+"px",left:"0px",display:"block"}).animate({top:"0px"},this.slideDuration);j.animate({top:(d.height())+"px"},this.slideDuration,function(){if(typeof n=="function"){n(this.currentPage,k,m)}});break;case"FLOAT_UP":d.css({top:b.height()+"px",left:"0px",display:"block"});d.animate({top:(f.height-d.height())+"px"},this.slideDuration,function(){if(typeof n=="function"){n(this.currentPage,k,m)}});break;case"FLOAT_DOWN":d.css({top:(-1*d.height())+"px",left:"0px",display:"block"}).animate({top:"0px"},this.slideDuration,function(){if(typeof n=="function"){n(this.currentPage,k,m)}});break;default:return}if(i==undefined||i==true){mui.history.push(k,m,this,2,h)}c=m;this.iScrollRefresh()}};this.panelIsOpen=function(){return d!=null};this.closePanel=function(h,j){if(f.panelIsOpen()){var k=$("#"+this.currentPageId);var i=d.attr("id");switch(c){case"NONE":d.css({top:"0px",left:"0px",display:"none"});f.removeCoverShild();if(typeof h=="function"){h(this.currentPage,i,c)}break;case"FADE":d.fadeOut(this.fadeDuration,function(){f.removeCoverShild();if(typeof h=="function"){h(this.currentPage,i,c)}});break;case"SLIDE_RIGHT":k.animate({left:"0px"},this.slideDuration,function(){f.removeCoverShild()});d.animate({left:(-1*d.width())+"px",display:"none"},this.slideDuration,function(){$(this).hide();if(typeof h=="function"){h(this.currentPage,i,c)}});break;case"SLIDE_LEFT":$(k).animate({left:"0px"},this.slideDuration,function(){f.removeCoverShild()});d.animate({top:"0px",left:b.width()+"px",display:"none"},this.slideDuration,function(){$(this).hide();if(typeof h=="function"){h(this.currentPage,i,c)}});break;case"FLOAT_RIGHT":d.animate({left:(-1*d.width())+"px",display:"none"},this.slideDuration,function(){$(this).hide();f.removeCoverShild();if(typeof h=="function"){h(this.currentPage,i,c)}});case"FLOAT_LEFT":d.animate({top:"0px",left:b.width()+"px",display:"none"},this.slideDuration,function(){$(this).hide();f.removeCoverShild();if(typeof h=="function"){h(this.currentPage,i,c)}});case"SLIDE_UP":d.animate({top:b.height()+"px"},this.slideDuration,function(){$(this).hide();if(typeof h=="function"){h(this.currentPage,i,c)}});k.animate({top:"0px"},this.slideDuration,function(){f.removeCoverShild()});break;case"SLIDE_DOWN":k.animate({top:"0px"},this.slideDuration,function(){f.removeCoverShild()});d.animate({top:(-1*d.height())+"px"},this.slideDuration,function(){$(this).hide();if(typeof h=="function"){h(this.currentPage,i,c)}});break;case"FLOAT_UP":d.animate({top:b.height()+"px"},this.slideDuration,function(){$(this).hide();f.removeCoverShild();if(typeof h=="function"){h(this.currentPage,i,c)}});break;case"FLOAT_DOWN":d.animate({top:(-1*d.height())+"px"},this.slideDuration,function(){$(this).hide();f.removeCoverShild();if(typeof h=="function"){h(this.currentPage,i,c)}});break;default:return}d=null;if(j==undefined||j==true){mui.history.pop()}this.iScrollRefresh(this.currentPageId)}};this.useIScroll=function(i){if(document.addEventListener){var h;if(i==undefined){h={click:false,preventDefault:false,scrollbars:mui.isMobileDevice.any()?false:true,fadeScrollbar:true,mouseWheel:true,interactiveScrollbars:true,keyBindings:mui.isMobileDevice.any()?false:true}}else{h=i}$(f.viewPortSelector+" .mui-scrollable").each(function(){$this=$(this);if($(this).children(".mui-scroll-wrapper").length==0){$this.css("overflow","hidden");$this.children().wrapAll("<div class='mui-scroll-wrapper' />");var j=new IScroll(this,h);$this.data("iScroll",j)}});document.addEventListener("touchmove",function(j){j.preventDefault()},false);this.isiScroll=true}else{$(".mui-scrollable").css("overflow","auto")}};this.iScrollRefresh=function(h){if(this.isiScroll){if(h==undefined){s=this.viewPortSelector+" .mui-scrollable"}else{s="#"+h+" .mui-scrollable"}$(s).each(function(){$this=$(this);var i=$this.data("iScroll");if(i!=undefined){i.refresh()}})}};this.putCoverShild=function(h,i){if(e==null){e=$("<div />");b.append(e)}if(i!=undefined){e.click(function(){i()})}if(h!=undefined&&h!=null){e.attr("class",h)}else{e.attr("class","mui-cover-shild")}e.css({position:"absolute",top:"0px",left:"0px",width:"100%",height:"100%",display:"block"})};this.removeCoverShild=function(){if(e!=null){e.hide()}};this.resize=function(){$("#"+f.currentPageId).height(b.height())};this.blur=function(h){var i=h!=undefined?h:"mui-blur";$("#"+this.currentPageId).addClass(i)};this.unblur=function(h){var i=h!=undefined?h:"mui-blur";$("#"+this.currentPageId).removeClass(i)};$("#"+f.currentPageId).css({display:"block",top:"0",left:"0",height:b.height()})};